<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

    <style>
        .section {
            margin-bottom: 6%;
        }

        .faq-row {
            margin-bottom: 2%;
        }

        #form-input {
            margin-bottom: 6%;
        }
    </style>

    <title>Melanoma Classification</title>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

    <script src="aws-sdk.js"></script>
</head>

<body>
    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
        crossorigin="anonymous"></script>


    <div class="container" style="margin-top:20px">
        <h1 align="center">
            Melanoma Classification
        </h1>


        <div id="motivation" class='section'>
            <h2>Motivation</h2>

            <div class="row">
                <div class="col-lg-8">

                    <p>
                        Skin cancer is the most prevalent type of cancer. Melanoma, specifically, is responsible for 75%
                        of
                        skin
                        cancer deaths, despite being the least common skin cancer. The American Cancer Society estimates
                        over
                        100,000 new melanoma cases will be diagnosed in 2020. It's also expected that almost 7,000
                        people
                        will die
                        from the disease. As with other cancers, early and accurate detection—potentially aided by data
                        science—can
                        make treatment more effective.
                    </p>

                    <p>
                        Currently, dermatologists evaluate every one of a patient's moles to identify outlier lesions or
                        “ugly ducklings” that are most likely to be melanoma. Existing AI approaches have not adequately
                        considered this clinical frame of reference. Dermatologists could enhance their diagnostic
                        accuracy
                        if detection algorithms take into account “contextual” images within the same patient to
                        determine
                        which
                        images represent a melanoma. If successful, classifiers would be more accurate and could better
                        support
                        dermatological clinic work.

                    </p>

                    <footer class="blockquote-footer">
                        From the SIIMISIC Melanoma Classification Challenge description
                    </footer>


                </div>

                <div class="col-lg-4">
                    <figure class="figure">
                        <img src="example.jpg" class="img-fluid rounded float-right" alt="...">
                        <figcaption class="figure-caption">An example of a non malignant skin lesion.</figcaption>
                    </figure>
                </div>

            </div>

        </div>


        <div class="border section" id="app" style=" padding: 20px;margin-bottom: 20px;">

            <div id="form-input">

                <h2>Get your results</h2>

                <div class="alert alert-primary" role="alert">
                    We only use the information to make a prediction. Once the prediction is done we delete everything.
                </div>

                <form name='form' onsubmit="return handleSubmit()">

                    <div class="form-row">

                        <div class="form-group col-lg-3">
                            <label for="ageInput">Age</label>
                            <input type="number" class="form-control" id="ageInput" aria-describedby="Enter your age"
                                placeholder="Enter your age">
                        </div>

                        <div class="form-group col-lg-3">
                            <label for="sexInput">Sex</label>
                            <select class="form-control" id="sexInput" required>
                                <option selected>choose...</option>
                                <option>male</option>
                                <option>female</option>
                            </select>
                        </div>

                        <div class="form-group col-lg-3">
                            <label for="location">Lesion Location</label>
                            <select class="form-control" id="location" required>
                                <option selected>choose...</option>
                                <option>head/neck</option>
                                <option>lower extremity</option>
                                <option>oral/genital</option>
                                <option>palms/soles</option>
                                <option>torso</option>
                                <option>upper extremity</option>
                            </select>
                        </div>

                        <div class="form-group col-lg-3">
                            <label for="formFile" class="form-label">Upload image</label>
                            <input class="form-control" type="file" id="formFile">
                        </div>

                    </div>

                    <button class="btn btn-primary" type="button" onclick="handleSubmit()">Submit</button>

                </form>

            </div>

            <div id="loading" hidden="true">

                <div class="row" style="margin-bottom: 0px; margin-top: -20px;">
                    <div class="col-lg-12">
                        <div class="alert alert-primary" role="alert">
                            Your image is being uploaded and processed. Please wait a few seconds...
                            <div class="spinner-border text-primary" role="status">
                                <span class="sr-only">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="error-api" hidden="true">

                <div class="row" style="margin-bottom: 0px; margin-top: -20px;">
                    <div class="col-lg-12">
                        <div class="alert alert-danger" role="alert">
                            It seems that we are having issues on our side. Please refresh the browser or try with a different image. 

                        </div>
                    </div>
                </div>
            </div>


            <div id="results-container" hidden="true">

                <h2>Results</h2>
                <div class="row">

                    <div class="col-lg-12">
                        <div class="alert alert-primary" role="alert" id="result-alert">
                            The image analyzed has a <span id="score">null</span>% probability of being malignant. This
                            puts
                            you in the <span class="percentile">null</span> th percentile, meaning <span
                                class="percentile">
                                null</span>% of images analyzed had a lower chance of being malignant.
                            <span id="advice" class="font-weight-bold"> You should see to the doctor inmediately. </span>
                        </div>
                    </div>

                </div>
            </div>

        </div>

        <div id="faq section">
            <h2>FAQ</h2>

            <div class="row faq-row">
                <div class="col-lg-12">
                    <h5>Is this a replacement for a doctor?</h5>

                    <em>No.</em> While this tool can provide some guidance, it has not gone through the procedures
                    that would allow it to perform health sensitive decisions. <span class="font-weight-bold">
                        It does not replace a doctor and if you have any reason to suspect the skin lesion could be an
                        issue you should see a specialist regardless of what the AI might say. </span>

                </div>
            </div>

            <div class="row faq-row">
                <div class="col-lg-12">
                    <h5>How should I take the picture?</h5>

                    Since the model was trained on <a
                        href="https://www.kaggle.com/c/siim-isic-melanoma-classification/data">
                        this data </a>, the more the input images look like them the more accurate the model will be.
                    This means
                    taking the photo from a centimeter or two at most, in a well lit condition, with a high quality
                    camera and
                    trying to make the image in-focus as much as possible.

                </div>
            </div>

            <div class="row faq-row">
                <div class="col-lg-12">
                    <h5>How was this model trained?</h5>

                    It was trained using more than 25000 cases from the <a
                        href="https://challenge2020.isic-archive.com/">
                        SIIM-ISIC Melanoma Classification Challenge</a>. If you want to take a look at what the training
                    process
                    looks like, we encourage you to take a look at <a
                        href="https://github.com/andresarpi3/melanoma-detection">
                        the repository of the project</a>.

                </div>
            </div>

            <div class="row faq-row">
                <div class="col-lg-12">
                    <h5>How accurate the model is?</h5>

                    The most usual metric used in classification problems is <em>accuracy</em>, which divides correct 
                    results divided by the total results. Our model has a accuracy of 99%. However, as 98% of instances
                    are negative, this metric is not useful. (The model could always return negative the predicted label
                    and get 98% accuracy).<br>
                    
                    Therefore,  
                    <a href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity">sensitivity and specificity</a>
                    are better metrics to asses the usefulness of the model. We are getting 80.56% and 78.77% respectively
                    if we set the positive threshold at 2.23%.

                </div>
            </div>

            <div class="row faq-row">
                <div class="col-lg-12">
                    <h5>Does that mean that if I got a score over 2.33% I have over 80% chance of being positive?</h5>

                    Absolutely not. If you are not mathematically inclined, just know that even if you got a high score,
                    the probability that you have a malignant lesion is low. Still, go to the doctor.<br><br>
                    A sensitivity of 80%
                    means that provided the person has a malignant tumor, there's an 80% chance the test will output
                    positive.
                    In mathematical terms: P(test being positive | person is positive) = P(PT | PP) = 80%. But this is
                    not at all what
                    we are interested in, in fact it's the reverse. What we care about is the probability that the
                    person positive
                    if the test came out positive: P(PP | PT). <br><br>

                    Thanks to Bayes theorem we can rewrite the second in terms of the first one: P(PP | PT) = P(PT | PP)
                    * P(PP) / P(PT).
                    This result comes at around 3%. However, since the benefit of an early detection compared to the
                    hassle of a trip
                    to the dermatologist is so great, we shouldn't be dismisive of the final number.
                </div>
            </div>


        </div>

        <div id="contact section">
            <h2>Conctact</h2>
            <a href="http://andresarpi.com/2022/02/01/melanoma-detector/">
                Take a look at the blog post I wrote explaining some of my reasoning.
            </a>
            If you have any other doubts regarding the project, don't hesitate to write me at andresarpi3@gmail.com

        </div>



        <script src="index.js"></script>
        <br></br>
</body>
</div>

</html>